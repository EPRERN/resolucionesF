<form (ngSubmit)="agregarResolucion()">
    <!-- Tema -->
    <label for="tema">Tema:</label>
    <select id="tema" [(ngModel)]="nuevaResolucion.tema.t_temasid" name="tema" required>
        <option *ngFor="let t of temas" [value]="t.t_temasid">
            {{ t.t_temasdescripcion }}
        </option>
    </select>
    
    <!-- Nro Resoluci칩n -->
    <label for="nro">Nro Resoluci칩n:</label>
    <input id="nro" type="text" [(ngModel)]="nuevaResolucion.t_resolucionesnro" name="nro" required>
    
    <!-- Expediente -->
    <label for="expte">Expediente:</label>
    <input id="expte" type="text" [(ngModel)]="nuevaResolucion.t_resolucionesexpte" name="expte">
    
    <!-- Car치tula -->
    <label for="caratula">Car치tula:</label>
    <input id="caratula" type="text" [(ngModel)]="nuevaResolucion.t_resolucionesexptecaratula" name="caratula">
    
    <!-- T칤tulo -->
    <label for="titulo">T칤tulo:</label>
    <input id="titulo" type="text" [(ngModel)]="nuevaResolucion.t_resolucionestitulo" name="titulo">
    
    <!-- Fecha -->
    <label for="fecha">Fecha:</label>
    <input id="fecha" type="text" [value]="formatDateToBackend(nuevaResolucion.t_resolucionesdate)" readonly>
    
    <!-- Distribuidora -->
    <label for="distribuidora">Distribuidora ID:</label>
    <input id="distribuidora" type="number" [(ngModel)]="nuevaResolucion.distribuidora.t_distribuidorasid" name="distribuidora" readonly>
    
    <!-- 游늭 Archivo Lotus (solo para parsear datos) -->
    <label for="lotusFile">Archivo Lotus:</label>
    <input id="lotusFile" type="file" (change)="onLotusFileSelected($event)">
    
    <!-- 游늯 Archivo PDF (este s칤 se guarda en BDD) -->
    <label for="pdfFile">Archivo PDF:</label>
    <input id="pdfFile" type="file" accept="application/pdf" (change)="onPdfFileSelected($event)">
    
    <button type="submit">Agregar</button>
</form>

<table>
    <thead>
        <tr>
            <th>Nro Resolucion</th>
            <th>T칤tulo</th>
            <th>Expte</th>
            <th>Car치tula</th>
            <th>Fecha</th>
            <th>Distribuidora</th>
            <th>Acciones</th>
            
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let r of resolucionesPaginadas">
            
            <td>{{ r.t_resolucionesnro }}</td>
            <td>{{ r.t_resolucionestitulo }}</td>
            <td>{{ r.t_resolucionesexpte }}</td>
            <td>{{ r.t_resolucionesexptecaratula }}</td>
            <td>{{ r.t_resolucionesdate | date }}</td>
            <td>{{ r.distribuidora.t_distribuidorasnombre }}</td>
            <td>
                <button (click)="eliminarResolucion(r.t_resolucionesid!)">Eliminar</button>
                <span *ngIf="!r.t_resolucionesblob">No hay archivo cargado</span>
                
                
                <button (click)="descargarPDF(r.t_resolucionesid!)">Descargar PDF</button>
                
                
                <button type="button" (click)="abrirPreview(r.t_resolucionesid!)"
                [disabled]="!r.t_resolucionesblob">Vista Previa</button>
            </td>
        </tr>
    </tbody>
    
    
    
    
</table>

<div class="paginador">
    <button (click)="page = page - 1" [disabled]="page === 1">Anterior</button>
    
    
    
    <button (click)="page = page + 1" [disabled]="page === totalPages">Siguiente</button>
    
    <span>P치gina</span>
    <input type="number" [(ngModel)]="page" name="pagina" [min]="1" [max]="totalPages" (change)="irAPagina()">
    <span>de&nbsp;{{ totalPages }}</span>
    
    <div class="filtros">
        <input type="text" placeholder="Filtrar por Nro" [(ngModel)]="filtroNro" (input)="aplicarFiltro()">&nbsp;&nbsp;
        <input type="text" placeholder="Filtrar por Expte" [(ngModel)]="filtroExpte" (input)="aplicarFiltro()">
    </div>
</div>

<app-pdf-preview *ngIf="pdfPreviewUrl" [fileUrl]="pdfPreviewUrl" (close)="cerrarPreview()"></app-pdf-preview>